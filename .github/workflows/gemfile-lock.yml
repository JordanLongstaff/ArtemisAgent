name: Update Gemfile.lock

on:
  push:
    branches: [ "main" ]
    paths:
      - .tool-versions
      - Gemfile
  schedule:
    - cron: '20 19 * * 0'

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  update:
    name: Update
    runs-on: macos-latest
    permissions:
      contents: write

    steps:
    - name: Checkout repository
      uses: actions/checkout@de0fac2e4500dabe0009e67214ff5f5447ce83dd # v6.0.2

    - name: Setup Ruby
      uses: ruby/setup-ruby@708024e6c902387ab41de36e1669e43b5ee7085e # v1.283.0
      with:
        bundler-cache: true

    - name: Update lockfile
      run: |
        bundle config set frozen false
        bundle update

    - name: Create Pull Request
      uses: peter-evans/create-pull-request@c0f553fe549906ede9cf27b5156039d195d2ece0 # v8.1.0
      with:
        add-paths: Gemfile.lock
        commit-message: "Update Gemfile.lock"
